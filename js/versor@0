(function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.versor=n()})(this,function(){"use strict";function t(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}var n=Math.acos,r=Math.asin,e=Math.atan2,a=Math.cos,u=Math.max,i=Math.min,o=Math.PI,f=Math.sin,c=Math.sqrt,s=o/180,h=180/o,d=function(t){var n=t[0]/2*s,r=f(n),e=a(n),u=t[1]/2*s,i=f(u),o=a(u),c=t[2]/2*s,h=f(c),d=a(c);return[e*o*d+r*i*h,r*o*d-e*i*h,e*i*d+r*o*h,e*o*h-r*i*d]};return d.cartesian=function(t){var n=t[0]*s,r=t[1]*s,e=a(r);return[e*a(n),e*f(n),f(r)]},d.rotation=function(t){return[e(2*(t[0]*t[1]+t[2]*t[3]),1-2*(t[1]*t[1]+t[2]*t[2]))*h,r(u(-1,i(1,2*(t[0]*t[2]-t[3]*t[1]))))*h,e(2*(t[0]*t[3]+t[1]*t[2]),1-2*(t[2]*t[2]+t[3]*t[3]))*h]},d.delta=function(r,e,o){2==arguments.length&&(o=1);var s=function(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}(r,e),h=c(t(s,s));if(!h)return[1,0,0,0];var d=o*n(u(-1,i(1,t(r,e))))/2,M=f(d);return[a(d),s[2]/h*M,-s[1]/h*M,s[0]/h*M]},d.multiply=function(t,n){return[t[0]*n[0]-t[1]*n[1]-t[2]*n[2]-t[3]*n[3],t[0]*n[1]+t[1]*n[0]+t[2]*n[3]-t[3]*n[2],t[0]*n[2]-t[1]*n[3]+t[2]*n[0]+t[3]*n[1],t[0]*n[3]+t[1]*n[2]-t[2]*n[1]+t[3]*n[0]]},d});